{{!< default}} {{! Everything inside the #post tags pulls data from the post }} {{#post}} <header class="post-header">
	<div class="inner">
		<h1 class="post-title">{{{title}}}</h1>
	</div>
	</header>

	<main class="content" role="main">
		<article class="{{post_class}}">
			<div class="inner">
				<section class="post-content">
					{{content}}
					<ul class="talks">
					</ul>

				</section>

			</div>
		</article>
	</main>

	{{/post}}

	<script type="text/x-tmpl" id="tmpl-memos">
		{% for (var i=0; i<o.data.length; i++) { %}
		<li class="timeline page-1">
			<div class="talks__avatar"><img src="https://cravatar.cn/avatar/cc38267b10cc25dfc62209f8ca34589e?d=identicon" alt="" /></div>
			<div class="talks__content">
				<div class="talks__text">
					<p>{%#  (o.data[i].content) %}</p>
					<div class="talks__imgs">
						{% if (!!o.data[i].imgs) { %}
							{% for (var b=0; b<o.data[i].imgs.length; b++) { %} 
								{%# o.data[i].imgs[b] %}
							{% } %}
						{% } %}
					</div>
				</div>
				<div class="talks__meta"><small class="talks__date">{%= new Date(o.data[i].createdTs * 1000).toLocaleString() %}</small></div>
			</div>
		</li>
		{% } %}

	</script>


	{{#contentFor "scripts"}}
	{{#if @custom.memos_url}}
		<script>
		$(document).ready(function () {
			var url = "{{{ @custom.memos_url }}}";
			const CODE_BLOCK_REG = /```([\s\S]*?)```\n?/g;
			const BOLD_TEXT_REG = /\*\*(.+?)\*\*/g;
			const EM_TEXT_REG = /\*(.+?)\*/g;
			const DOT_LI_REG = /[*-] /g;
			const NUM_LI_REG = /(\d+)\. /g;
			const TODO_BLOCK_REG = /- \[ \] /g;
			const DONE_BLOCK_REG = /- \[x\] /g;
			// tag regex
			const TAG_REG = /#([^\s#]+?) /g;
			// markdown image regex
			const IMAGE_URL_REG = /!\[.*?\]\((.+?)\)\n?/g;
			// markdown link regex
			const LINK_URL_REG = /\[(.*?)\]\((.+?)\)/g;
			// linked memo regex
			const MEMO_LINK_REG = /@\[(.+?)\]\((.+?)\)/g;

			
			$.getJSON(url, function(data,status,xhr){
				data['url'] = this.url.match(/https:\/\/([^\/]+)\//i)[1];
				$(data.data).each(function(i,d){
					d.imgs = d.content.match(/!\[(.*?)\]\((.*?)\)/mg)
					d.content = d.content.replace(/([\u4e00-\u9fa5])([A-Za-z0-9?.,;[\]]+)/g, "$1 $2")
					.replace(/([A-Za-z0-9?.,;[\]]+)([\u4e00-\u9fa5])/g, "$1 $2")
					.replace(CODE_BLOCK_REG, "<pre lang=''>$1</pre>")
					.replace(DOT_LI_REG, "<span class='counter-block'>â€¢</span>")
					.replace(NUM_LI_REG, "<span class='counter-block'>$1.</span>")
					.replace(BOLD_TEXT_REG, "<strong>$1</strong>")
					.replace(EM_TEXT_REG, "<em>$1</em>")
					.replace(MEMO_LINK_REG, "<span class='memo-link-text' data-value='$2'>$1</span>")
					.replace(TAG_REG, "<span class='tag-span'>#$1</span> ")
					.replace(/!\[(.*?)\]\((.*?)\)/mg,"")
					.replace(LINK_URL_REG, "<a class='link' target='_blank' rel='noreferrer' href='$2'>$1</a>")
					$(d.imgs).each(function(i,b){
						d.imgs[i] = b.replace(IMAGE_URL_REG, "<img class='img' src='//"+ data.url +"$1' />");
					})
				});
				
				$('.talks').html(tmpl('tmpl-memos', data))
			});
		});
		</script>
	{{/if}}
	{{/contentFor}}